#####Mahout Notes

RecommenderJob

######PreparePreferenceMatrixJob

有3个job

1. convert items to an internal index

输入格式：userid，itemid，value,建立索引,因为数据量大?


1. convert user preferences into a vector per user

如果vector含有的item个数大于或等于minPreference（这里看出这个参数的意义了吧）就输出，否则不输出。

最后代码获得了用户的个数

输出:
		
	userid-->vector[itemid:prefValue,itemid:prefValue,...]


1. build the rating matrix

mapper输出是 

	itemID-->vector[userID:prefValue]

同时还有两个计数器，因为numElementsBeforeSampling - numElementsAfterSampling=0，所以计数器Elements.USER_RATINGS_NEGLECTED就一直是零。

reducer:

	itemID-->vector[userID:prefValue，userID:prefVlaue,...]

以上三个步骤的输出格式

	ITEMID_INDEX=================
	{102=102, 103=103, 101=101, 106=106, 107=107, 104=104, 105=105}
	USER_VECTORS================
	{1={103:2.5,102:3.0,101:5.0}, 2={101:2.0,104:2.0,103:5.0,102:2.5}, 3={101:2.5,107:5.0,105:4.5,104:4.0}, 4={101:5.0,106:4.0,104:4.5,103:3.0}, 5={106:4.0,105:3.5,104:4.0,103:2.0,102:3.0,101:4.0}}
	RATING_MATRIX================
	{102={5:3.0,2:2.5,1:3.0}, 103={5:2.0,4:3.0,2:5.0,1:2.5}, 101={5:4.0,4:5.0,3:2.5,2:2.0,1:5.0}, 106={5:4.0,4:4.0}, 107={3:5.0}, 104={5:4.0,4:4.5,3:4.0,2:2.0}, 105={5:3.5,3:4.5}}



######RowSimilarityJob

calculate the co-occurrence matrix,计算共生矩阵,有3个job

1. normsAndTranspose

输入：

	itemID-->vector[userID:prefValue，userID:prefVlaue,...]

输出路径是：weightsPath，格式：

<key,value>   -->       <userid,vector[itemid:prefValue,itemid:prefValue,...]。

2. pairwiseSimilarity

mapper输出:

	<key,value>   -->  <itemid,vector[itemid:pref*,itemid,pref*,...]


最终输出路径是：pairwiseSimilarityPath

输出格式是

	<key,value> -->  <itemid,vector[itemid:simi,itemid:simi,...]>


3. asMatrix


以上3个JOb的输出

	weights=================
	{1={103:2.5,102:3.0,101:5.0}, 2={101:2.0,104:2.0,103:5.0,102:2.5}, 3={101:2.5,107:5.0,105:4.5,104:4.0}, 4={101:5.0,106:4.0,104:4.5,103:3.0}, 5={106:4.0,105:3.5,104:4.0,103:2.0,102:3.0,101:4.0}}
	normsPath=================
	{107:25.0,106:32.0,105:32.5,104:56.25,103:44.25,102:24.25,101:76.25}
	maxValues=================
	{}
	numNonZeroEntries=================
	{}
	pairwiseSimilarityPath=================
	{102={106:0.14972506706560876,105:0.14328432723886902,104:0.12789210656028413,103:0.1975496259559987}, 103={106:0.1424339656566283,105:0.11208890297777215,104:0.14037600977966974}, 101={107:0.10275248635596666,106:0.1424339656566283,105:0.1158457425543559,104:0.16015261286229274,103:0.15548737703860027,102:0.14201473202245876}, 106={}, 107={}, 104={107:0.13472338607037426,106:0.18181818181818182,105:0.16736577623297264}, 105={107:0.2204812092115424,106:0.14201473202245876}}
	similarityMatrix=================
	{102={101:0.14201473202245876,106:0.14972506706560876,105:0.14328432723886902,104:0.12789210656028413,103:0.1975496259559987}, 103={101:0.15548737703860027,106:0.1424339656566283,105:0.11208890297777215,104:0.14037600977966974,102:0.1975496259559987}, 101={107:0.10275248635596666,106:0.1424339656566283,105:0.1158457425543559,104:0.16015261286229274,103:0.15548737703860027,102:0.14201473202245876}, 106={101:0.1424339656566283,105:0.14201473202245876,104:0.18181818181818182,103:0.1424339656566283,102:0.14972506706560876}, 107={105:0.2204812092115424,104:0.13472338607037426,101:0.10275248635596666}, 104={107:0.13472338607037426,106:0.18181818181818182,105:0.16736577623297264,103:0.14037600977966974,102:0.12789210656028413,101:0.16015261286229274}, 105={107:0.2204812092115424,106:0.14201473202245876,104:0.16736577623297264,103:0.11208890297777215,102:0.14328432723886902,101:0.1158457425543559}}
	
#####

**Reference**

[http://blog.csdn.net/fansy1990/article/details/12589765](http://blog.csdn.net/fansy1990/article/details/12589765)